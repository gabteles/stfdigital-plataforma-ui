{"version":3,"sources":["processos/pesquisa-avancada/pesquisa-avancada.controller.ts"],"names":[],"mappings":"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","file":"processos/pesquisa-avancada/pesquisa-avancada.controller.js","sourcesContent":["module app.processos.pesquisaAvancada {\r\n    'use strict';\r\n    import IScope = angular.IScope;\r\n    import ITranslateService = angular.translate.ITranslateService;\r\n    import IToastService = angular.material.IToastService;\r\n    import ISidenavService = angular.material.ISidenavService;\r\n    import IDialogService = angular.material.IDialogService;\r\n    \r\n    class PesquisaAvancadaController {\r\n\r\n        public defaultSearch: ISearch;\r\n        public newSearch: ISearch;\r\n        public loadedSearch: ISearch;\r\n        public resultSearch: ISearch;\r\n        public selectedTab: number;\r\n        public searchComplete: boolean;\r\n        public editEnabled: boolean;\r\n        public resultsDtOptions: any;\r\n        \r\n        /** @ngInject **/\r\n        constructor(private $scope: IScope,\r\n                    private $translate: ITranslateService,\r\n                    private $mdDialog: IDialogService,\r\n                    private $mdToast: IToastService,\r\n                    private $mdSidenav: ISidenavService,\r\n                    public traits: ITrait[],\r\n                    public savedSearchs: ISearch[],\r\n                    public searchResults: any) {\r\n\r\n            this.defaultSearch = <ISearch>{id: null, label: '', criterias: []};\r\n\r\n            this.newSearch = angular.copy(this.defaultSearch);\r\n            this.loadedSearch = angular.copy(this.defaultSearch);\r\n            this.resultSearch = angular.copy(this.defaultSearch);\r\n            this.selectedTab = 0;\r\n            this.searchComplete = false;\r\n            this.editEnabled = false;\r\n            this.resultsDtOptions = this.defineResultsDtOptions();\r\n        }\r\n\r\n        private defineResultsDtOptions(): any {\r\n             return {\r\n                dom: '<\"top\"f>rt<\"bottom\"<\"left\"<\"length\"l>><\"right\"<\"info\"i><\"pagination\"p>>>',\r\n                pagingType: 'simple',\r\n                autoWidth: true,\r\n                responsive: false,\r\n                searching: false\r\n            };\r\n        }\r\n\r\n        public canSearch(): boolean {\r\n            var search = (this.selectedTab === 0 ? this.newSearch : this.loadedSearch);\r\n            return ((search.criterias.length > 0) && (_.every(search.criterias, 'valid')));\r\n        }\r\n\r\n        public doSearch(): void {\r\n            if (this.selectedTab === 0) {\r\n                angular.copy(this.newSearch, this.resultSearch);\r\n                angular.copy(this.newSearch, this.loadedSearch);\r\n                angular.copy(this.defaultSearch, this.newSearch);\r\n            } else {\r\n                angular.copy(this.loadedSearch, this.resultSearch);\r\n            }\r\n            this.selectedTab = 1;\r\n            this.searchComplete = true;\r\n            this.editEnabled = true;\r\n        }\r\n\r\n        public saveSearch(event): void {\r\n            this.$mdDialog.show({\r\n                clickOutsideToClose: true,\r\n                controller: /** @ngInject */ function ($rootScope, $mdDialog, searchName) {\r\n                    var vm = this;\r\n                    vm.searchName = searchName;\r\n                    vm.cancel = function () {\r\n                        $mdDialog.hide();\r\n                    };\r\n                    vm.confirm = function () {\r\n                        $rootScope.$broadcast('save-search:confirm', vm.searchName);\r\n                        $mdDialog.cancel();\r\n                    };\r\n                },\r\n                resolve: {\r\n                    searchName: function() {\r\n                        return (this.resultSearch.id === null ? '' : this.resultSearch.label);\r\n                    }.bind(this)\r\n                },\r\n                controllerAs: 'vm',\r\n                templateUrl: 'app/main/processos/pesquisa-avancada/modals/save-search-name/save-search-name.html',\r\n                parent: angular.element(document.body),\r\n                targetEvent: event\r\n            });\r\n\r\n            var removeListener = this.$scope.$on('save-search:confirm', function(event, label) {\r\n                if (this.resultSearch.id === null) {\r\n                    var id = this.savedSearchs.length;\r\n                    this.savedSearchs.push(angular.copy(this.resultSearch));\r\n                    this.savedSearchs[id].id = id;\r\n                    this.savedSearchs[id].label = label;\r\n                } else {\r\n                    angular.copy(this.resultSearch, this.savedSearchs[this.resultSearch.id]);\r\n                    this.savedSearchs[this.resultSearch.id].label = label;\r\n                }\r\n                this.$mdToast.show(\r\n                    this.$mdToast.simple()\r\n                        .textContent(this.$translate(\"PROCESSOS.PESQUISA-AVANCADA.PESQUISA-SALVA\"))\r\n                        .position('top right')\r\n                        .hideDelay(3000)\r\n                );\r\n                removeListener();\r\n            });\r\n        }\r\n\r\n        public openSavedSearchs(): void {\r\n            this.$mdSidenav('sidenav').open();\r\n        }\r\n\r\n        public loadSearch(savedSearch: ISearch): void {\r\n            angular.copy(savedSearch, this.loadedSearch);\r\n            this.$mdSidenav('sidenav').close();\r\n            this.selectedTab = 2;\r\n            this.editEnabled = true;\r\n        }\r\n    }\r\n    \r\n    angular\r\n        .module('app.processos.pesquisa-avancada')\r\n        .controller('app.processos.pesquisa-avancada.PesquisaAvancadaController', PesquisaAvancadaController);\r\n}"],"sourceRoot":"/source/"}